<div class="create-comic-container">
  <h2>Add a New Comic</h2>

  <form [formGroup]="createForm" (ngSubmit)="onSubmit()">
    <!-- Comic Name -->
    <div class="form-group">
      <label for="name">Comic Name:</label>
      <input id="name" formControlName="name" type="text" class="form-control" placeholder="Enter comic name">
      @if (createForm.get('name')?.hasError('required') && createForm.get('name')?.touched) {
        <small class="error">Name is required.</small>
      }
      @if (createForm.get('name')?.hasError('minlength') && createForm.get('name')?.touched) {
        <small class="error">Name cannot be less than 3 characters.</small>
      }
      @if (createForm.get('name')?.hasError('comicNameTaken') && createForm.get('name')?.touched) {
        <small class="error">Name is already taken.</small>
      }
    </div>

    <!-- Comic Description -->
    <div class="form-group">
      <label for="description">Description:</label>
      <textarea id="description" formControlName="description" class="form-control" placeholder="Enter comic description"></textarea>
      @if (createForm.get('description')?.hasError('required') && createForm.get('description')?.touched) {
        <small class="error">Description is required.</small>
      }
      @if (createForm.get('description')?.hasError('minlength') && createForm.get('description')?.touched) {
        <small class="error">Description cannot be less than 10 characters.</small>
      }
    </div>

    <!-- Status -->
    <div class="form-group">
      <label for="status">Status:</label>
      <select id="status" formControlName="status" class="form-control">
        <option value="">Select status</option>
        <option value="ongoing">Ongoing</option>
        <option value="completed">Completed</option>
      </select>
      @if (createForm.get('status')?.hasError('required') && createForm.get('status')?.touched) {
        <small class="error">Status is required.</small>
      }
    </div>

    <!-- Age Rating -->
    <div class="form-group">
      <label for="ageRating">Age Rating:</label>
      <select id="ageRating" formControlName="ageRating" class="form-control">
        <option value="">Select age rating</option>
        <option value="13+">13+</option>
        <option value="15+">15+</option>
        <option value="17+">17+</option>
      </select>
      @if (createForm.get('ageRating')?.hasError('required') && createForm.get('ageRating')?.touched) {
        <small class="error">Age rating is required.</small>
      }
    </div>

    <!-- Genres -->
    <div class="form-group">
      <label for="genres">Genres:</label>
      <select id="genres" formControlName="genres" class="form-control" multiple>
        <option value="action">Action</option>
        <option value="comedy">Comedy</option>
        <option value="drama">Drama</option>
        <option value="horror">Horror</option>
        <option value="fantasy">Fantasy</option>
        <option value="romance">Romance</option>
      </select>
      @if (createForm.get('genres')?.hasError('required') && createForm.get('genres')?.touched) {
        <small class="error">Genres are required.</small>
      }
    </div>

    <!-- Upload Cover Image -->
    <div class="form-group">
      <label for="coverImage">Upload Cover Image:</label>
      <input id="coverImage" type="file" (change)="onFileChange($event)" accept="image/*" class="form-control">
      <div *ngIf="coverImageError" class="error">
        {{ coverImageError }}
      </div>
      <div *ngIf="!coverImage" class="error">
        Cover image is required.
      </div>
      <!-- Display selected image -->
      <div *ngIf="coverImage">
        <h4>Cover Image Preview:</h4>
        <img [src]="coverImagePreview" alt="Cover Image Preview" style="max-width: 200px; max-height: 200px; object-fit: cover;">
      </div>
    </div>

    <!-- Додайте цей блок перед кнопкою -->
<div *ngIf="isLoading" class="loading-overlay">
  <div class="spinner"></div>
  <p>Uploading...</p>
</div>

<!-- Змінюємо кнопку, щоб вона відключалася під час завантаження -->
<button type="submit" class="btn btn-primary" [disabled]="createForm.invalid || !coverImage || isLoading">
  {{ isLoading ? 'Uploading...' : 'Add Comic' }}
</button>

  </form>
</div>
